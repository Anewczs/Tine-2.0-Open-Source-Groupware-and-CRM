Ext.namespace("Egw.Admin");Egw.Admin=function(){var b=function(){var N=new Ext.tree.TreeLoader({dataUrl:"index.php"});N.on("beforeload",function(q,M){q.baseParams.method="Admin.getSubTree";q.baseParams.node=M.id;q.baseParams.location="mainTree";},this);var I=new Ext.tree.TreePanel({title:"Admin",id:"admin-tree",loader:N,rootVisible:false,border:false});var r=new Ext.tree.TreeNode({text:"root",draggable:false,allowDrop:false,id:"root"});I.setRootNode(r);for(i=0;i<initialTree.Admin.length;i++){r.appendChild(new Ext.tree.AsyncTreeNode(initialTree.Admin[i]));}I.on("click",function(q,M){var D=Egw.Egwbase.getActiveToolbar();switch(q.attributes.dataPanelType){case "applications":if(D!=false&&D.id=="toolbarAdminApplications"){Ext.getCmp("gridAdminApplications").getStore().load({params:{start:0,limit:50}});}else{Egw.Admin.Applications.show();}break;}},this);I.on("beforeexpand",function(M){if(M.getSelectionModel().getSelectedNode()==null){M.expandPath("/root");M.selectPath("/root/applications");}M.fireEvent("click",M.getSelectionModel().getSelectedNode());},this);I.on("contextmenu",function(q,M){M.stopEvent();});return I;};return {getPanel:b,};}();Egw.Admin.Applications=function(){var I=function(E,D){var x=Ext.getCmp("grid_applications").getSelectionModel().getSelections();var L=x[0].id;Egw.Egwbase.openWindow("applicationWindow","index.php?method=Admin.getApplication&appId="+L,800,450);};var q=new Ext.Action({text:"edit",disabled:true,handler:I,iconCls:"action_edit"});var N=function(){var D=new Ext.data.JsonStore({url:"index.php",baseParams:{method:"Admin.getApplications"},root:"results",totalProperty:"totalcount",id:"app_id",fields:[{name:"app_id"},{name:"app_name"},{name:"app_enabled"},{name:"app_order"},{name:"app_tables"},{name:"app_version"}],remoteSort:true});D.setDefaultSort("app_name","asc");D.load({params:{start:0,limit:50}});return D;};var r=function(){var x=new Ext.app.SearchField({id:"quickSearchField",width:240,emptyText:"enter searchfilter"});var D=new Ext.Toolbar({id:"toolbarAdminApplications",split:false,height:26,items:[q,"->","Search:"," "," ",x]});Egw.Egwbase.setActiveToolbar(D);};var b=function(x,P,H,D,E,L){switch(x){case "0":return "disabled";break;case "1":return "enabled";break;case "2":return "enabled but hidden";break;case "3":return "enabled (new window)";break;default:return "unknown status ("+x+")";break;}};var M=function(){var D=N();var E=new Ext.PagingToolbar({pageSize:50,store:D,displayInfo:true,displayMsg:"Displaying application {0} - {1} of {2}",emptyMsg:"No applications to display"});var L=new Ext.grid.ColumnModel([{resizable:true,header:"order",id:"app_order",dataIndex:"app_order",width:50},{resizable:true,header:"name",id:"app_name",dataIndex:"app_name"},{resizable:true,header:"status",id:"app_enabled",dataIndex:"app_enabled",width:150,renderer:b},{resizable:true,header:"version",id:"app_version",dataIndex:"app_version",width:70}]);L.defaultSortable=true;var x=new Ext.grid.GridPanel({id:"gridAdminApplications",store:D,cm:L,tbar:E,autoSizeColumns:false,selModel:new Ext.grid.RowSelectionModel({multiSelect:true}),enableColLock:false,autoExpandColumn:"app_name",border:false});Egw.Egwbase.setActiveContentPanel(x);x.on("rowclick",function(y,h,P){var H=y.getSelectionModel().getCount();});x.on("rowcontextmenu",function(P,H,h){h.stopEvent();if(!P.getSelectionModel().isSelected(H)){P.getSelectionModel().selectRow(H);}});x.on("rowdblclick",function(P,h,y){var H=P.getStore().getAt(h);try{openWindow("listWindow","index.php?method=Addressbook.editList&_listId="+H.data.list_id,800,450);}catch(S){}});return ;};return {show:function(){r();M();}};}();